import os
import torch
from torchvision import transforms, datasets
import torchvision
import torch.nn as nn
import torch.nn.functional as F
from torch.autograd import Variable
import numpy as np
from torch.utils.data import Dataset, DataLoader
import cv2
from PIL import Image
import csv
import random

### SC ###
basiloma1 = ["114865","114926","114997","115009","115053","115119","115299","125362","125960","126062","126126","126204"]
basiloma2 = ["126492","126603","126621","126649","126742","126858","126862","137087","137181","137292","138051","138096"] 
basiloma3 = ["138119","138254","138268","138278","138332","138382","148757","148859","148917","149157","149636","149647"]
basiloma4 = ["1510834","1510846","1511532","1612073","1612378","1612391","1612445","1612454","1612552","1612685","1612761","1713253"]
basiloma5 = ["1713377","1713657","1713814","1713908","1714104","1815845","1916277","1916506","1916736","1916877","1917061","1917074"] 

bowen1 = ["114833","115192","125440","125662","126307","126377"] 
bowen2 = ["149760","1510864","1510866","1511004","1511409","1511459"] 
bowen3 = ["1612348","1612412","1612435","1612475","1612579","1612592"] 
bowen4 = ["1612975","1612994","1713759","1714260","1815257","1916385"] 
bowen5 = ["1916698","1916817","1916984","1917088","1917199","1917266"]

squamous1 = ["114832","137522","137534","137844","138083","138126","148588","148639","148831","149143","1917203"]
squamous2 = ["149175","149215","149377","149509","149704","149763","149945","149954","1510833","1510870","1917213"]
squamous3 = ["1511019","1511021","1511055","1511067","1511569","1611621","1611682","1611934","1612364","1612401","2017403"]
squamous4 = ["1612447","1612455","1612583","1612610","1613010","1713552","1714430B","1814720","1815262","1815496","2017440"]
squamous5 = ["1815676A","1815813","1915940","1916427","1916477","1916527","1916563","1916637","1916767","1916794","1916910"]


### RC-Hong Ren ###
kirc1 = ['B0-5691', 'B0-5693', 'B0-4707', 'DV-5566', 'A3-3358', 'B0-5088', 'CJ-4900', 'BP-4999', 'A3-3336', 'DV-5565', 'CJ-6030', 'A3-3329']
kirc2 = ['B2-5635', 'B0-5698', 'DV-5574', 'BP-4353', 'BP-4986', 'CJ-4904', 'BP-4327', 'BP-4775', 'BP-4160', 'CJ-4891', 'CJ-6027', 'BP-4807']
kirc3 = ['A3-3325', 'BP-5181', 'BP-4344', 'BP-4995', 'B0-5695', 'AK-3450', 'BP-5009', 'BP-4799', 'CZ-4865', 'BP-5191', 'A3-3319', 'B8-4153','DV-5573','BP-4331','BP-4760','CJ-4869','BP-4976','BP-4354','BP-4334','BP-4965','B0-4712','B8-4621','BP-4993','DV-5576','BP-4988','DV-5567','CZ-4862','A3-3343','B8-5162','CJ-5689','B8-4148','CJ-4894']
kirc4 = ['B0-5812', 'BP-4342', 'DV-5568', 'BP-5178', 'CJ-4642', 'DV-5575', 'BP-4994', 'DV-5569', 'BP-5168', 'BP-5006', 'A3-3307', 'CZ-4856']
kirc5 = ['BP-4158', 'AK-3425', 'BP-5199', 'B0-5694', 'A3-3308', 'A3-3365', 'A3-A8OV', 'B0-5098', 'B2-4102', 'B8-4143', 'BP-4989', 'CZ-4864']

kirp1 = ['BQ-7046', 'AT-A5NU', 'UZ-A9Q0', 'BQ-7049', 'Y8-A898', 'BQ-7055', 'A4-7288', 'SX-A71W', 'BQ-7058', 'MH-A857', 'DW-5561', 'BQ-5886']
kirp2 = ['BQ-5888', 'Q2-A5QZ', '2Z-A9JE', '2Z-A9J8', 'GL-7966', 'SX-A7SP', 'A4-8518', 'SX-A7SL', 'MH-A561', 'A4-7734', 'DW-7834', 'IA-A83W']
kirp3 = ['B9-A44B', 'UZ-A9PV', 'DW-5560', '2Z-A9J2', '5P-A9KF', 'BQ-5879', 'BQ-5876', '5P-A9K9', 'KV-A6GE', 'B1-A47N', 'B3-3925', 'BQ-5882','DW-7836','BQ-7056','BQ-5892','G7-A8LE','B1-A47O','AL-A5DJ','DZ-6134','B9-5156','HE-7129','2Z-A9JN','Y8-A8S1','P4-AAVO','5P-A9JW','B3-A6W5','Y8-A897','UZ-A9Q1','A4-7585','IA-A40X','A4-8312','UZ-A9PP']
kirp4 = ['2Z-A9JO', 'BQ-5887', '5P-A9K6', 'DW-7841', 'DW-7840', '5P-A9K3', 'DW-7842', 'DW-7838', 'EV-5902', 'B9-5155', 'DW-7839', 'G7-6790']
kirp5 = ['P4-A5EB', 'DW-7837', 'A4-7584', 'BQ-5884', 'AL-3468', 'B1-A47M', 'B3-4104', 'B9-4113', 'BQ-5885', 'BQ-5889', 'HE-A5NI', 'IZ-8196']

kich1 = ['UW-A72S', 'UW-A72I', 'UW-A72H', 'KN-8424', 'KN-8432', 'UW-A72N', 'KN-8419', 'KN-8418', 'KO-8406', 'KL-8339', 'UW-A72O', 'UW-A72L']
kich2 = ['KL-8325', 'KL-8335', 'KO-8405', 'KN-8436', 'KL-8329', 'KM-8443', 'KO-8408', 'KO-8411', 'KL-8330', 'KO-8407', 'UW-A72P', 'UW-A72T']
kich3 = ['NP-A5GY', 'KL-8328', 'KO-8415', 'KN-8431', 'KL-8340', 'KN-8435', 'KN-8423', 'KL-8337', 'KL-8331', 'KL-8332', 'KO-8416', 'KL-8326','KM-A7Q7','KM-8439','UW-A72R','KM-A7Q9','KM-A7Q8','NP-A5H6','UW-A72K','NP-A5H5','NP-A5H1','UW-A72Q','KM-8441','KL-8333','KL-8324','KO-8417','KM-8438','KO-8413','KM-8639','KN-8421','KN-8429','KL-8338']
kich4 = ['NP-A5H7', 'NP-A5GZ', 'UW-A72J', 'KN-8430', 'KN-8437', 'KL-8342', 'KO-8414', 'KL-8344', 'KO-8421', 'KL-8334', 'KO-8409', 'KL-8346']
kich5 = ['KO-8410', 'KN-8426', 'KL-8327', 'KM-8442', 'KN-8427', 'KN-8428', 'KN-8433', 'KO-8403', 'KO-8404', 'NP-A5B3', 'UW-A7GU', 'UW-A72M']

### BC ###
UDH_train = ['1244', '1270', '1326', '1335', '1337', '1409', '1495', '1498', '1581', '1594', '1596', '1604', '1606', '1617', '1618', '1621', '1642', '1667', '1780', '1782', '1783', '1785', '1786', '1787', '1789', '1791', '1792', '1793', '1834', '1836', '1837', '1873', '1881', '1914', '1917', '1918', '1946', '1949', '1957', '1958', '1959', '1963', '1993', '1995', '1996', '1997', '2001', '2005', '3273', '3278', '3310', '3313', '3317', '1003685', '1003705', '1003707']
UDH_test = ['1334', '1416', '1619', '1821', '1824', '1848', '1853', '1896', '1952', '265', '1295', '1591', '1592', '1595', '1609', '3284', '1003660', '1003661']
ADH_train = ['1379', '1486', '1494', '1499', '1616', '1622', '1794', '1795', '1808', '1860', '1861', '1863', '1877', '1882', '1899', '1911', '1912', '1913', '1915', '1922', '1925', '1932', '1933', '1934', '1969', '1987', '3318', '1003728']
ADH_test = ['1228', '1503', '1589', '1825', '1844', '1849', '1856', '1892', '1895', '1938', '1003691', '1003694', '1271', '1797', '1876', '1885', '1953', '1977', '1982', '1983']
DCIS_train = ['755', '762', '1238', '1247', '1369', '1489', '1490', '1491', '1492', '1496', '1497', '1509', '1512', '1514', '1515', '1653', '1771', '1811', '1816', '1835', '1840', '1862', '1864', '1874', '1888', '1903', '1919', '1920', '1921', '1923', '1927', '1928', '1929', '1930', '1931', '1947', '1950', '1970', '1999', '1003697']
DCIS_test = ['1283', '1473', '1474', '1476', '1588', '1597', '1602', '1867', '1872', '1878', '1897', '1945', '735', '736', '737', '1366', '1367', '1607', '1883', '1935', '3302']

### RC-My ###
# kirc1 = ['B8-4143', 'B0-5691', 'B0-5693', 'B0-4707', 'DV-5566', 'A3-3358', 'B0-5088', 'CJ-4900', 'BP-4999', 'BP-4989', 'A3-3336', 'DV-5565']
# kirc2 = ['A3-3329', 'A3-3308', 'B2-5635', 'B0-5698', 'A3-3319', 'DV-5574', 'BP-4353', 'BP-4986', 'CJ-4904', 'BP-4327', 'BP-4775', 'BP-4160']
# kirc3 = ['A3-3325', 'BP-5181', 'BP-4344', 'BP-4995', 'B0-5695', 'AK-3450', 'BP-5009', 'BP-4799', 'CZ-4865', 'BP-5191', 'CZ-4864', 'CJ-6030']
# kirc4 = ['CJ-4891', 'CJ-6027', 'BP-4807', 'B0-5812', 'BP-4342', 'DV-5568', 'BP-5178', 'CJ-4642', 'DV-5575', 'BP-4994', 'DV-5569', 'BP-5168']
# kirc5 = ['BP-5006', 'A3-3307', 'CZ-4856', 'BP-4158', 'AK-3425', 'BP-5199', 'B0-5694', 'B2-4102', 'A3-3365', 'B8-4153', 'B0-5098', 'A3-A8OV']

# kirp1 = ['BQ-7046', 'AT-A5NU', 'UZ-A9Q0', 'BQ-7049', 'B3-3925', 'Y8-A898', 'BQ-7055', 'A4-7288', 'SX-A71W', 'BQ-7058', 'HE-A5NI', 'DW-5561']
# kirp2 = ['BQ-5886', 'BQ-5888', 'Q2-A5QZ', '2Z-A9JE', '2Z-A9J8', 'BQ-5889', 'GL-7966', 'SX-A7SP', 'A4-8518', 'SX-A7SL', 'MH-A561', 'A4-7734']
# kirp3 = ['B9-A44B', 'UZ-A9PV', 'DW-5560', '2Z-A9J2', '5P-A9KF', 'BQ-5879', 'BQ-5876', '5P-A9K9', 'KV-A6GE', 'B1-A47N', 'B9-4113', 'MH-A857']
# kirp4 = ['DW-7834', 'IA-A83W', 'BQ-5885', '2Z-A9JO', 'BQ-5887', '5P-A9K6', 'DW-7841', 'DW-7840', '5P-A9K3', 'DW-7842', 'DW-7838', 'B1-A47M']
# kirp5 = ['EV-5902', 'B9-5155', 'DW-7839', 'IZ-8196', 'G7-6790', 'P4-A5EB', 'DW-7837', 'A4-7584', 'BQ-5884', 'BQ-5882', 'B3-4104', 'AL-3468']

# kich1 = ['UW-A72S', 'UW-A7GU', 'UW-A72I', 'UW-A72H', 'KN-8424', 'KN-8432', 'UW-A72N', 'KN-8419', 'KN-8418', 'KO-8406', 'UW-A72L', 'KL-8325']
# kich2 = ['KL-8335', 'KL-8326', 'KO-8405', 'KN-8436', 'KL-8329', 'KM-8443', 'KO-8408', 'KO-8411', 'KL-8330', 'KO-8407', 'UW-A72P', 'UW-A72T']
# kich3 = ['NP-A5GY', 'KL-8328', 'KO-8415', 'KN-8431', 'KL-8340', 'KN-8435', 'KN-8423', 'KL-8337', 'KL-8331', 'KL-8332', 'KL-8339', 'UW-A72O']
# kich4 = ['NP-A5H7', 'NP-A5GZ', 'UW-A72J', 'KN-8430', 'KN-8437', 'KL-8342', 'KO-8414', 'KL-8344', 'KN-8428', 'KN-8433', 'KO-8421', 'KL-8334']
# kich5 = ['KO-8409', 'KL-8346', 'KO-8410', 'KO-8404', 'KN-8426', 'KN-8427', 'KL-8327', 'KM-8442', 'NP-A5B3', 'KO-8416', 'KO-8403', 'UW-A72M']

def SC_make_dataset(num):
    data_map = {}
    data_map['data1'] = [basiloma1, squamous1, bowen1]
    data_map['data2'] = [basiloma2, squamous2, bowen2]
    data_map['data3'] = [basiloma3, squamous3, bowen3]
    data_map['data4'] = [basiloma4, squamous4, bowen4]
    data_map['data5'] = [basiloma5, squamous5, bowen5]

    num_list = [l for l in num]
    name_list = []

    for n in num_list:
        test_BCC = data_map[f'data{n}'][0]
        test_SCC = data_map[f'data{n}'][1]
        test_BD = data_map[f'data{n}'][2]
        for i in test_BCC:
            name_list.append([i, 0])
        for j in test_SCC:
            name_list.append([j, 1])
        for k in test_BD:
            name_list.append([k, 2])
    
    return name_list

def BC_make_dataset(num):
    data_map = {}
    data_map['data1'] = [UDH_train, ADH_train, DCIS_train]
    data_map['data2'] = [UDH_test, ADH_test, DCIS_test]
    num_list = [l for l in num]
    name_list = []

    for n in num_list:
        UDH = data_map[f'data{n}'][0]
        ADH = data_map[f'data{n}'][1]
        DCIS = data_map[f'data{n}'][2]
        for i in UDH:
            name_list.append([i, 0])
        for j in ADH:
            name_list.append([j, 1])
        for k in DCIS:
            name_list.append([k, 2])
    
    return name_list

def RC_make_dataset(num):
    data_map = {}
    data_map['data1'] = [kirc1, kirp1, kich1]
    data_map['data2'] = [kirc2, kirp2, kich2]
    data_map['data3'] = [kirc3, kirp3, kich3]
    data_map['data4'] = [kirc4, kirp4, kich4]
    data_map['data5'] = [kirc5, kirp5, kich5]

    num_list = [l for l in num]
    name_list = []

    for n in num_list:
        test_KIRC = data_map[f'data{n}'][0]
        test_KIRP = data_map[f'data{n}'][1]
        test_KICH = data_map[f'data{n}'][2]
        for i in test_KIRC:
            name_list.append([i, 0])
        for j in test_KIRP:
            name_list.append([j, 1])
        for k in test_KICH:
            name_list.append([k, 2])
    
    return name_list